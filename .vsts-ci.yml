# Build environment:
# https://docs.microsoft.com/en-us/vsts/build-release/concepts/definitions/build/variables?tabs=batch

steps:
- bash: mkdir -pv ./gopath/src/github.com/mweagle/helloworld
  displayName: Initialize source directory

- bash: |
    for EACHFILE in $(ls .);
    do if [ $EACHFILE != "gopath" ];
      then mv -v $EACHFILE ./gopath/src/github.com/mweagle/helloworld/$EACHFILE;
    fi;
    done
  displayName: Move source

- bash: curl -L -O https://dl.google.com/go/go1.9.2.linux-amd64.tar.gz
  displayName: Download Go

- bash: tar -xzf go1.9.2.linux-amd64.tar.gz -C $BUILD_SOURCESDIRECTORY
  displayName: Expand Go

- bash: ls -la .
  displayName: Directory Listing

- bash: env
  displayName: Build Environmennt

- bash: pwd
  displayName: Current Directory

- bash: env && $BUILD_SOURCESDIRECTORY/go/bin/go build
  workingDirectory: ./gopath/src/github.com/mweagle/helloworld
  env:
    GOPATH: $(BUILD_SOURCESDIRECTORY)/gopath
    GOROOT: $(BUILD_SOURCESDIRECTORY)/go
  displayName: Build
